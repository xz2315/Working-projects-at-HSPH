*****************************************
Frailty Indicator & Chronic Condition 30's for Medicare 5% sample
Xiner Zhou
12/15/2015
*****************************************;
libname MedPar 'C:\data\Data\Medicare\MedPAR';
libname OP 'C:\data\Data\Medicare\Outpatient';
libname Carrier 'C:\data\Data\Medicare\Carrier';
libname HHA 'C:\data\Data\Medicare\HHA';
libname HOSPICE 'C:\data\Data\Medicare\Hospice';
libname SNF 'C:\data\Data\Medicare\SNF';
libname DME 'C:\data\Data\Medicare\DME';
libname IP 'C:\data\Data\Medicare\Inpatient';

libname HCC 'C:\data\Projects\Peterson';
 
 
*IP;

proc sql;
create table IP2009_0 as
select bene_id, 
case when  (DGNSCD1 in ("7812") or DGNSCD2 in ("7812") or DGNSCD3 in ("7812") or DGNSCD4 in ("7812") or DGNSCD5 in ("7812") or DGNSCD6 in ("7812") or DGNSCD7 in ("7812") or DGNSCD8 in ("7812") or DGNSCD9 in ("7812") or DGNSCD10 in ("7812")) then 1 else 0 end as Frail1 , 
case when  (DGNSCD1 in (select ICD from HCC.Icd2hccxw2013 where HCC=21) or DGNSCD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) ) then 1 else 0 end as Frail2, 
case when  (DGNSCD1 in ("7837") or DGNSCD2 in ("7837") or DGNSCD3 in ("7837") or DGNSCD4 in ("7837") or DGNSCD5 in ("7837") or DGNSCD6 in ("7837") or DGNSCD7 in ("7837") or DGNSCD8 in ("7837") or DGNSCD9 in ("7837") or DGNSCD10 in ("7837")) then 1 else 0 end as Frail3, 
case when  (DGNSCD1 in ("7994") or DGNSCD2 in ("7994") or DGNSCD3 in ("7994") or DGNSCD4 in ("7994") or DGNSCD5 in ("7994") or DGNSCD6 in ("7994") or DGNSCD7 in ("7994") or DGNSCD8 in ("7994") or DGNSCD9 in ("7994") or DGNSCD10 in ("7994")) then 1 else 0 end as Frail4, 
case when  (DGNSCD1 in ("7993") or DGNSCD2 in ("7993") or DGNSCD3 in ("7993") or DGNSCD4 in ("7993") or DGNSCD5 in ("7993") or DGNSCD6 in ("7993") or DGNSCD7 in ("7993") or DGNSCD8 in ("7993") or DGNSCD9 in ("7993") or DGNSCD10 in ("7993")) then 1 else 0 end as Frail5, 
case when  (DGNSCD1 in ("7197") or DGNSCD2 in ("7197") or DGNSCD3 in ("7197") or DGNSCD4 in ("7197") or DGNSCD5 in ("7197") or DGNSCD6 in ("7197") or DGNSCD7 in ("7197") or DGNSCD8 in ("7197") or DGNSCD9 in ("7197") or DGNSCD10 in ("7197")) then 1 else 0 end as Frail6, 
case when  (DGNSCD1 in ("V1588") or DGNSCD2 in ("V1588") or DGNSCD3 in ("V1588") or DGNSCD4 in ("V1588") or DGNSCD5 in ("V1588") or DGNSCD6 in ("V1588") or DGNSCD7 in ("V1588") or DGNSCD8 in ("V1588") or DGNSCD9 in ("V1588") or DGNSCD10 in ("V1588")) then 1 else 0 end as Frail7, 
case when  (DGNSCD1 in ("7282") or DGNSCD2 in ("7282") or DGNSCD3 in ("7282") or DGNSCD4 in ("7282") or DGNSCD5 in ("7282") or DGNSCD6 in ("7282") or DGNSCD7 in ("7282") or DGNSCD8 in ("7282") or DGNSCD9 in ("7282") or DGNSCD10 in ("7282")) then 1 else 0 end as Frail8, 
case when  (DGNSCD1 in ("72887") or DGNSCD2 in ("72887") or DGNSCD3 in ("72887") or DGNSCD4 in ("72887") or DGNSCD5 in ("72887") or DGNSCD6 in ("72887") or DGNSCD7 in ("72887") or DGNSCD8 in ("72887") or DGNSCD9 in ("72887") or DGNSCD10 in ("72887")) then 1 else 0 end as Frail9, 
case when  (DGNSCD1 in (select ICD from HCC.Icd2hccxw2013 where HCC=148) or DGNSCD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) ) then 1 else 0 end as Frail10, 
case when  (DGNSCD1 in ("797") or DGNSCD2 in ("797") or DGNSCD3 in ("797") or DGNSCD4 in ("797") or DGNSCD5 in ("797") or DGNSCD6 in ("797") or DGNSCD7 in ("797") or DGNSCD8 in ("797") or DGNSCD9 in ("797") or DGNSCD10 in ("797")) then 1 else 0 end as Frail11  
from IP.Inptclms2009;
quit;

proc sql;
create table IP2009_1 as
select bene_id, 
case when  HCPCS_CD in ('E0100', 'E0105', 'E0130', 'E0135', 'E0140', 'E0141', 'E0143', 'E0144', 'E0147', 'E0148', 'E0149', 'E0160', 'E0161','E0162','E0163','E0164','E0165','E0166','E0167','E0168','E0169','E0170','E0171') 
then 1 else 0 end as frail12 
from IP.Inptrev2009;
quit;
  
*OP;
proc sql;
create table OP2009_0 as
select bene_id, 
case when  (DGNSCD1 in ("7812") or DGNSCD2 in ("7812") or DGNSCD3 in ("7812") or DGNSCD4 in ("7812") or DGNSCD5 in ("7812") or DGNSCD6 in ("7812") or DGNSCD7 in ("7812") or DGNSCD8 in ("7812") or DGNSCD9 in ("7812") or DGNSCD10 in ("7812")) then 1 else 0 end as Frail1, 
case when  (DGNSCD1 in (select ICD from HCC.Icd2hccxw2013 where HCC=21) or DGNSCD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNSCD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) )then 1 else 0 end as Frail2, 
case when  (DGNSCD1 in ("7837") or DGNSCD2 in ("7837") or DGNSCD3 in ("7837") or DGNSCD4 in ("7837") or DGNSCD5 in ("7837") or DGNSCD6 in ("7837") or DGNSCD7 in ("7837") or DGNSCD8 in ("7837") or DGNSCD9 in ("7837") or DGNSCD10 in ("7837")) then 1 else 0 end as Frail3, 
case when  (DGNSCD1 in ("7994") or DGNSCD2 in ("7994") or DGNSCD3 in ("7994") or DGNSCD4 in ("7994") or DGNSCD5 in ("7994") or DGNSCD6 in ("7994") or DGNSCD7 in ("7994") or DGNSCD8 in ("7994") or DGNSCD9 in ("7994") or DGNSCD10 in ("7994")) then 1 else 0 end as Frail4, 
case when  (DGNSCD1 in ("7993") or DGNSCD2 in ("7993") or DGNSCD3 in ("7993") or DGNSCD4 in ("7993") or DGNSCD5 in ("7993") or DGNSCD6 in ("7993") or DGNSCD7 in ("7993") or DGNSCD8 in ("7993") or DGNSCD9 in ("7993") or DGNSCD10 in ("7993")) then 1 else 0 end as Frail5, 
case when  (DGNSCD1 in ("7197") or DGNSCD2 in ("7197") or DGNSCD3 in ("7197") or DGNSCD4 in ("7197") or DGNSCD5 in ("7197") or DGNSCD6 in ("7197") or DGNSCD7 in ("7197") or DGNSCD8 in ("7197") or DGNSCD9 in ("7197") or DGNSCD10 in ("7197")) then 1 else 0 end as Frail6, 
case when  (DGNSCD1 in ("V1588") or DGNSCD2 in ("V1588") or DGNSCD3 in ("V1588") or DGNSCD4 in ("V1588") or DGNSCD5 in ("V1588") or DGNSCD6 in ("V1588") or DGNSCD7 in ("V1588") or DGNSCD8 in ("V1588") or DGNSCD9 in ("V1588") or DGNSCD10 in ("V1588")) then 1 else 0 end as Frail7, 
case when  (DGNSCD1 in ("7282") or DGNSCD2 in ("7282") or DGNSCD3 in ("7282") or DGNSCD4 in ("7282") or DGNSCD5 in ("7282") or DGNSCD6 in ("7282") or DGNSCD7 in ("7282") or DGNSCD8 in ("7282") or DGNSCD9 in ("7282") or DGNSCD10 in ("7282")) then 1 else 0 end as Frail8, 
case when  (DGNSCD1 in ("72887") or DGNSCD2 in ("72887") or DGNSCD3 in ("72887") or DGNSCD4 in ("72887") or DGNSCD5 in ("72887") or DGNSCD6 in ("72887") or DGNSCD7 in ("72887") or DGNSCD8 in ("72887") or DGNSCD9 in ("72887") or DGNSCD10 in ("72887")) then 1 else 0 end as Frail9, 
case when  (DGNSCD1 in (select ICD from HCC.Icd2hccxw2013 where HCC=148) or DGNSCD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNSCD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) ) then 1 else 0 end as Frail10, 
case when  (DGNSCD1 in ("797") or DGNSCD2 in ("797") or DGNSCD3 in ("797") or DGNSCD4 in ("797") or DGNSCD5 in ("797") or DGNSCD6 in ("797") or DGNSCD7 in ("797") or DGNSCD8 in ("797") or DGNSCD9 in ("797") or DGNSCD10 in ("797")) then 1 else 0 end as Frail11  
from OP.Otptclms2009;
quit;

proc sql;
create table OP2009_1 as
select bene_id, 
case when  HCPCS_CD in ('E0100', 'E0105', 'E0130', 'E0135', 'E0140', 'E0141', 'E0143', 'E0144', 'E0147', 'E0148', 'E0149', 'E0160', 'E0161','E0162','E0163','E0164','E0165','E0166','E0167','E0168','E0169','E0170','E0171') 
then 1 else 0 end as frail12 
from OP.Otptrev2009;
quit;
  


*Carrier;
proc sql;
create table Carrier2009_0 as
select bene_id, 
case when  (DGNS_CD1  in ("7812") or DGNS_CD2  in ("7812") or DGNS_CD3  in ("7812") or DGNS_CD4  in ("7812") or DGNS_CD5  in ("7812") or DGNS_CD6  in ("7812") or DGNS_CD7  in ("7812") or DGNS_CD8  in ("7812") ) then 1 else 0 end as Frail1, 
case when  (DGNS_CD1 in (select ICD from HCC.Icd2hccxw2013 where HCC=21) or DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=21)) then 1 else 0 end as Frail2, 
case when  (DGNS_CD1 in ("7837") or DGNS_CD2 in ("7837") or DGNS_CD3 in ("7837") or DGNS_CD4 in ("7837") or DGNS_CD5 in ("7837") or DGNS_CD6 in ("7837") or DGNS_CD7 in ("7837") or DGNS_CD8 in ("7837") ) then 1 else 0 end as Frail3, 
case when  (DGNS_CD1 in ("7994") or DGNS_CD2 in ("7994") or DGNS_CD3 in ("7994") or DGNS_CD4 in ("7994") or DGNS_CD5 in ("7994") or DGNS_CD6 in ("7994") or DGNS_CD7 in ("7994") or DGNS_CD8 in ("7994") ) then 1 else 0 end as Frail4, 
case when  (DGNS_CD1 in ("7993") or DGNS_CD2 in ("7993") or DGNS_CD3 in ("7993") or DGNS_CD4 in ("7993") or DGNS_CD5 in ("7993") or DGNS_CD6 in ("7993") or DGNS_CD7 in ("7993") or DGNS_CD8 in ("7993") ) then 1 else 0 end as Frail5, 
case when  (DGNS_CD1 in ("7197") or DGNS_CD2 in ("7197") or DGNS_CD3 in ("7197") or DGNS_CD4 in ("7197") or DGNS_CD5 in ("7197") or DGNS_CD6 in ("7197") or DGNS_CD7 in ("7197") or DGNS_CD8 in ("7197") ) then 1 else 0 end as Frail6, 
case when  (DGNS_CD1 in ("V1588") or DGNS_CD2 in ("V1588") or DGNS_CD3 in ("V1588") or DGNS_CD4 in ("V1588") or DGNS_CD5 in ("V1588") or DGNS_CD6 in ("V1588") or DGNS_CD7 in ("V1588") or DGNS_CD8 in ("V1588")) then 1 else 0 end as Frail7, 
case when  (DGNS_CD1 in ("7282") or DGNS_CD2 in ("7282") or DGNS_CD3 in ("7282") or DGNS_CD4 in ("7282") or DGNS_CD5 in ("7282") or DGNS_CD6 in ("7282") or DGNS_CD7 in ("7282") or DGNS_CD8 in ("7282") ) then 1 else 0 end  as Frail8, 
case when  (DGNS_CD1 in ("72887") or DGNS_CD2 in ("72887") or DGNS_CD3 in ("72887") or DGNS_CD4 in ("72887") or DGNS_CD5 in ("72887") or DGNS_CD6 in ("72887") or DGNS_CD7 in ("72887") or DGNS_CD8 in ("72887") ) then 1 else 0 end as Frail9, 
case when  (DGNS_CD1 in (select ICD from HCC.Icd2hccxw2013 where HCC=148) or DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) ) then 1 else 0 end as Frail10, 
case when  (DGNS_CD1 in ("797") or DGNS_CD2 in ("797") or DGNS_CD3 in ("797") or DGNS_CD4 in ("797") or DGNS_CD5 in ("797") or DGNS_CD6 in ("797") or DGNS_CD7 in ("797") or DGNS_CD8 in ("797") ) then 1 else 0 end as Frail11  
from Carrier.Bcarclms2009;
quit;

proc sql;
create table Carrier2009_1 as
select bene_id, 
case when  HCPCS_CD in ('E0100', 'E0105', 'E0130', 'E0135', 'E0140', 'E0141', 'E0143', 'E0144', 'E0147', 'E0148', 'E0149', 'E0160', 'E0161','E0162','E0163','E0164','E0165','E0166','E0167','E0168','E0169','E0170','E0171') 
then 1 else 0 end as frail12 
from Carrier.Bcarline2009;
quit;

 
 
*HHA;
 proc sql;
create table HHA2009_0 as
select bene_id, 
case when  (PRNCPAL_DGNS_CD  in ("7812") or ICD_DGNS_CD1  in ("7812") or ICD_DGNS_CD2  in ("7812") or ICD_DGNS_CD3  in ("7812") or ICD_DGNS_CD4  in ("7812") or ICD_DGNS_CD5  in ("7812") or ICD_DGNS_CD6  in ("7812") or ICD_DGNS_CD7  in ("7812") or ICD_DGNS_CD8  in ("7812") or ICD_DGNS_CD9  in ("7812") or ICD_DGNS_CD10  in ("7812") or ICD_DGNS_CD11  in ("7812") or ICD_DGNS_CD12  in ("7812")  or ICD_DGNS_CD13  in ("7812") or ICD_DGNS_CD14  in ("7812") or ICD_DGNS_CD15  in ("7812") or ICD_DGNS_CD16  in ("7812") or ICD_DGNS_CD17  in ("7812") or ICD_DGNS_CD18  in ("7812") or ICD_DGNS_CD19  in ("7812") or ICD_DGNS_CD20  in ("7812") or ICD_DGNS_CD21  in ("7812") or ICD_DGNS_CD22  in ("7812") or ICD_DGNS_CD23  in ("7812") or ICD_DGNS_CD24  in ("7812") or ICD_DGNS_CD25  in ("7812")) then 1 else 0 end as Frail1, 
case when  (PRNCPAL_DGNS_CD in (select ICD from HCC.Icd2hccxw2013 where HCC=21) or ICD_DGNS_CD1 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD11 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD12 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD13 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD14 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD15 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD16 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD17 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD18 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD19 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD20 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD21 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD22 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD23 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD24 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD25 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) ) then 1 else 0 end as Frail2, 
case when  (PRNCPAL_DGNS_CD in ("7837") or ICD_DGNS_CD1 in ("7837") or ICD_DGNS_CD2 in ("7837") or ICD_DGNS_CD3 in ("7837") or ICD_DGNS_CD4 in ("7837") or ICD_DGNS_CD5 in ("7837") or ICD_DGNS_CD6 in ("7837") or ICD_DGNS_CD7 in ("7837") or ICD_DGNS_CD8 in ("7837") or ICD_DGNS_CD9 in ("7837") or ICD_DGNS_CD10 in ("7837") or ICD_DGNS_CD11 in ("7837") or ICD_DGNS_CD12 in ("7837") or ICD_DGNS_CD13 in ("7837") or ICD_DGNS_CD14 in ("7837") or ICD_DGNS_CD15 in ("7837") or ICD_DGNS_CD16 in ("7837") or ICD_DGNS_CD17 in ("7837") or ICD_DGNS_CD18 in ("7837") or ICD_DGNS_CD19 in ("7837") or ICD_DGNS_CD20 in ("7837") or ICD_DGNS_CD21 in ("7837") or ICD_DGNS_CD22 in ("7837") or ICD_DGNS_CD23 in ("7837") or ICD_DGNS_CD24 in ("7837") or ICD_DGNS_CD25 in ("7837") ) then 1 else 0 end as Frail3, 
case when  (PRNCPAL_DGNS_CD in ("7994") or ICD_DGNS_CD1 in ("7994") or ICD_DGNS_CD2 in ("7994") or ICD_DGNS_CD3 in ("7994") or ICD_DGNS_CD4 in ("7994") or ICD_DGNS_CD5 in ("7994") or ICD_DGNS_CD6 in ("7994") or ICD_DGNS_CD7 in ("7994") or ICD_DGNS_CD8 in ("7994") or ICD_DGNS_CD9 in ("7994") or ICD_DGNS_CD10 in ("7994") or ICD_DGNS_CD11 in ("7994") or ICD_DGNS_CD12 in ("7994") or ICD_DGNS_CD13 in ("7994") or ICD_DGNS_CD14 in ("7994") or ICD_DGNS_CD15 in ("7994") or ICD_DGNS_CD16 in ("7994") or ICD_DGNS_CD17 in ("7994") or ICD_DGNS_CD18 in ("7994") or ICD_DGNS_CD19 in ("7994") or ICD_DGNS_CD20 in ("7994") or ICD_DGNS_CD21 in ("7994") or ICD_DGNS_CD22 in ("7994") or ICD_DGNS_CD23 in ("7994") or ICD_DGNS_CD24 in ("7994") or ICD_DGNS_CD25 in ("7994")  ) then 1 else 0 end as Frail4, 
case when  (PRNCPAL_DGNS_CD in ("7993") or ICD_DGNS_CD1 in ("7993") or ICD_DGNS_CD2 in ("7993") or ICD_DGNS_CD3 in ("7993") or ICD_DGNS_CD4 in ("7993") or ICD_DGNS_CD5 in ("7993") or ICD_DGNS_CD6 in ("7993")  or ICD_DGNS_CD7 in ("7993")  or ICD_DGNS_CD8 in ("7993")  or ICD_DGNS_CD9 in ("7993")  or ICD_DGNS_CD10 in ("7993")  or ICD_DGNS_CD11 in ("7993")  or ICD_DGNS_CD12 in ("7993")  or ICD_DGNS_CD13 in ("7993")  or ICD_DGNS_CD14 in ("7993")  or ICD_DGNS_CD15 in ("7993")  or ICD_DGNS_CD16 in ("7993")  or ICD_DGNS_CD17 in ("7993")  or ICD_DGNS_CD18 in ("7993")  or ICD_DGNS_CD19 in ("7993")  or ICD_DGNS_CD20 in ("7993")  or ICD_DGNS_CD21 in ("7993")  or ICD_DGNS_CD22 in ("7993")  or ICD_DGNS_CD23 in ("7993")  or ICD_DGNS_CD24 in ("7993")  or ICD_DGNS_CD25 in ("7993")  ) then 1 else 0 end as Frail5, 
case when  (PRNCPAL_DGNS_CD in ("7197") or ICD_DGNS_CD1 in ("7197") or ICD_DGNS_CD2 in ("7197") or ICD_DGNS_CD3 in ("7197") or ICD_DGNS_CD4 in ("7197") or ICD_DGNS_CD5 in ("7197") or ICD_DGNS_CD6 in ("7197") or ICD_DGNS_CD7 in ("7197") or ICD_DGNS_CD8 in ("7197") or ICD_DGNS_CD9 in ("7197") or ICD_DGNS_CD10 in ("7197") or ICD_DGNS_CD11 in ("7197") or ICD_DGNS_CD12 in ("7197") or ICD_DGNS_CD13 in ("7197") or ICD_DGNS_CD14 in ("7197") or ICD_DGNS_CD15 in ("7197") or ICD_DGNS_CD16 in ("7197") or ICD_DGNS_CD17 in ("7197") or ICD_DGNS_CD18 in ("7197") or ICD_DGNS_CD19 in ("7197") or ICD_DGNS_CD20 in ("7197") or ICD_DGNS_CD21 in ("7197") or ICD_DGNS_CD22 in ("7197") or ICD_DGNS_CD23 in ("7197") or ICD_DGNS_CD24 in ("7197") or ICD_DGNS_CD25 in ("7197") ) then 1 else 0 end as Frail6, 
case when  (PRNCPAL_DGNS_CD in ("V1588") or ICD_DGNS_CD1 in ("V1588") or ICD_DGNS_CD2 in ("V1588") or ICD_DGNS_CD3 in ("V1588") or ICD_DGNS_CD4 in ("V1588") or ICD_DGNS_CD5 in ("V1588") or ICD_DGNS_CD6 in ("V1588") or ICD_DGNS_CD7 in ("V1588") or ICD_DGNS_CD8 in ("V1588") or ICD_DGNS_CD9 in ("V1588") or ICD_DGNS_CD10 in ("V1588") or ICD_DGNS_CD11 in ("V1588") or ICD_DGNS_CD12 in ("V1588") or ICD_DGNS_CD13 in ("V1588") or ICD_DGNS_CD14 in ("V1588") or ICD_DGNS_CD15 in ("V1588") or ICD_DGNS_CD16 in ("V1588") or ICD_DGNS_CD17 in ("V1588") or ICD_DGNS_CD18 in ("V1588") or ICD_DGNS_CD19 in ("V1588") or ICD_DGNS_CD20 in ("V1588") or ICD_DGNS_CD21 in ("V1588") or ICD_DGNS_CD22 in ("V1588") or ICD_DGNS_CD23 in ("V1588") or ICD_DGNS_CD24 in ("V1588") or ICD_DGNS_CD25 in ("V1588")  ) then 1 else 0 end as Frail7, 
case when  (PRNCPAL_DGNS_CD in ("7282") or ICD_DGNS_CD1 in ("7282") or ICD_DGNS_CD2 in ("7282") or ICD_DGNS_CD3 in ("7282") or ICD_DGNS_CD4 in ("7282") or ICD_DGNS_CD5 in ("7282") or ICD_DGNS_CD6 in ("7282")  or ICD_DGNS_CD7 in ("7282") or ICD_DGNS_CD8 in ("7282") or ICD_DGNS_CD9 in ("7282") or ICD_DGNS_CD10 in ("7282") or ICD_DGNS_CD11 in ("7282") or ICD_DGNS_CD12 in ("7282") or ICD_DGNS_CD13 in ("7282") or ICD_DGNS_CD14 in ("7282") or ICD_DGNS_CD15 in ("7282") or ICD_DGNS_CD16 in ("7282") or ICD_DGNS_CD17 in ("7282") or ICD_DGNS_CD18 in ("7282") or ICD_DGNS_CD19 in ("7282") or ICD_DGNS_CD20 in ("7282") or ICD_DGNS_CD21 in ("7282") or ICD_DGNS_CD22 in ("7282") or ICD_DGNS_CD23 in ("7282") or ICD_DGNS_CD24 in ("7282") or ICD_DGNS_CD25 in ("7282") ) then 1 else 0 end as Frail8, 
case when  (PRNCPAL_DGNS_CD in ("72887") or ICD_DGNS_CD1 in ("72887") or ICD_DGNS_CD2 in ("72887") or ICD_DGNS_CD3 in ("72887") or ICD_DGNS_CD4 in ("72887") or ICD_DGNS_CD5 in ("72887") or ICD_DGNS_CD6 in ("72887") or ICD_DGNS_CD7 in ("72887") or ICD_DGNS_CD8 in ("72887") or ICD_DGNS_CD9 in ("72887") or ICD_DGNS_CD10 in ("72887") or ICD_DGNS_CD11 in ("72887") or ICD_DGNS_CD12 in ("72887") or ICD_DGNS_CD13 in ("72887") or ICD_DGNS_CD14 in ("72887") or ICD_DGNS_CD15 in ("72887") or ICD_DGNS_CD16 in ("72887") or ICD_DGNS_CD17 in ("72887") or ICD_DGNS_CD18 in ("72887") or ICD_DGNS_CD19 in ("72887") or ICD_DGNS_CD20 in ("72887") or ICD_DGNS_CD21 in ("72887") or ICD_DGNS_CD22 in ("72887") or ICD_DGNS_CD23 in ("72887") or ICD_DGNS_CD24 in ("72887") or ICD_DGNS_CD25 in ("72887")   ) then 1 else 0 end as Frail9, 
case when  (PRNCPAL_DGNS_CD in (select ICD from HCC.Icd2hccxw2013 where HCC=148) or ICD_DGNS_CD1 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD11 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD12 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD13 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD14 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD15 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD16 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD17 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD18 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD19 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD20 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD21 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD22 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD23 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD24 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD25 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  ) then 1 else 0 end as Frail10, 
case when  (PRNCPAL_DGNS_CD in ("797") or ICD_DGNS_CD1 in ("797") or ICD_DGNS_CD2 in ("797") or ICD_DGNS_CD3 in ("797") or ICD_DGNS_CD4 in ("797") or ICD_DGNS_CD5 in ("797") or ICD_DGNS_CD6 in ("797") or ICD_DGNS_CD7 in ("797")  or ICD_DGNS_CD8 in ("797")  or ICD_DGNS_CD9 in ("797")  or ICD_DGNS_CD10 in ("797")  or ICD_DGNS_CD11 in ("797")  or ICD_DGNS_CD12 in ("797")  or ICD_DGNS_CD13 in ("797")  or ICD_DGNS_CD14 in ("797")  or ICD_DGNS_CD15 in ("797")  or ICD_DGNS_CD16 in ("797")  or ICD_DGNS_CD17 in ("797")  or ICD_DGNS_CD18 in ("797")  or ICD_DGNS_CD19 in ("797")  or ICD_DGNS_CD20 in ("797")  or ICD_DGNS_CD21 in ("797")  or ICD_DGNS_CD22 in ("797")  or ICD_DGNS_CD23 in ("797")  or ICD_DGNS_CD24 in ("797")  or ICD_DGNS_CD25 in ("797")  ) then 1 else 0 end as Frail11  
from HHA.Hhaclms2009;
quit;

proc sql;
create table HHA2009_1 as
select bene_id, 
case when  HCPCS_CD in ('E0100', 'E0105', 'E0130', 'E0135', 'E0140', 'E0141', 'E0143', 'E0144', 'E0147', 'E0148', 'E0149', 'E0160', 'E0161','E0162','E0163','E0164','E0165','E0166','E0167','E0168','E0169','E0170','E0171') 
then 1 else 0 end as frail12 
from HHA.Hharev2009;
quit;





*Hospice;
 proc sql;
create table Hospice2009_0 as
select bene_id, 
case when  (PRNCPAL_DGNS_CD  in ("7812") or ICD_DGNS_CD1  in ("7812") or ICD_DGNS_CD2  in ("7812") or ICD_DGNS_CD3  in ("7812") or ICD_DGNS_CD4  in ("7812") or ICD_DGNS_CD5  in ("7812") or ICD_DGNS_CD6  in ("7812") or ICD_DGNS_CD7  in ("7812") or ICD_DGNS_CD8  in ("7812") or ICD_DGNS_CD9  in ("7812") or ICD_DGNS_CD10  in ("7812") or ICD_DGNS_CD11  in ("7812") or ICD_DGNS_CD12  in ("7812")  or ICD_DGNS_CD13  in ("7812") or ICD_DGNS_CD14  in ("7812") or ICD_DGNS_CD15  in ("7812") or ICD_DGNS_CD16  in ("7812") or ICD_DGNS_CD17  in ("7812") or ICD_DGNS_CD18  in ("7812") or ICD_DGNS_CD19  in ("7812") or ICD_DGNS_CD20  in ("7812") or ICD_DGNS_CD21  in ("7812") or ICD_DGNS_CD22  in ("7812") or ICD_DGNS_CD23  in ("7812") or ICD_DGNS_CD24  in ("7812") or ICD_DGNS_CD25  in ("7812")) then 1 else 0 end as Frail1, 
case when  (PRNCPAL_DGNS_CD in (select ICD from HCC.Icd2hccxw2013 where HCC=21) or ICD_DGNS_CD1 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD11 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD12 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD13 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD14 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD15 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD16 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD17 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD18 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD19 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD20 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD21 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD22 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD23 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD24 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD25 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) ) then 1 else 0 end as Frail2, 
case when  (PRNCPAL_DGNS_CD in ("7837") or ICD_DGNS_CD1 in ("7837") or ICD_DGNS_CD2 in ("7837") or ICD_DGNS_CD3 in ("7837") or ICD_DGNS_CD4 in ("7837") or ICD_DGNS_CD5 in ("7837") or ICD_DGNS_CD6 in ("7837") or ICD_DGNS_CD7 in ("7837") or ICD_DGNS_CD8 in ("7837") or ICD_DGNS_CD9 in ("7837") or ICD_DGNS_CD10 in ("7837") or ICD_DGNS_CD11 in ("7837") or ICD_DGNS_CD12 in ("7837") or ICD_DGNS_CD13 in ("7837") or ICD_DGNS_CD14 in ("7837") or ICD_DGNS_CD15 in ("7837") or ICD_DGNS_CD16 in ("7837") or ICD_DGNS_CD17 in ("7837") or ICD_DGNS_CD18 in ("7837") or ICD_DGNS_CD19 in ("7837") or ICD_DGNS_CD20 in ("7837") or ICD_DGNS_CD21 in ("7837") or ICD_DGNS_CD22 in ("7837") or ICD_DGNS_CD23 in ("7837") or ICD_DGNS_CD24 in ("7837") or ICD_DGNS_CD25 in ("7837") ) then 1 else 0 end as Frail3, 
case when  (PRNCPAL_DGNS_CD in ("7994") or ICD_DGNS_CD1 in ("7994") or ICD_DGNS_CD2 in ("7994") or ICD_DGNS_CD3 in ("7994") or ICD_DGNS_CD4 in ("7994") or ICD_DGNS_CD5 in ("7994") or ICD_DGNS_CD6 in ("7994") or ICD_DGNS_CD7 in ("7994") or ICD_DGNS_CD8 in ("7994") or ICD_DGNS_CD9 in ("7994") or ICD_DGNS_CD10 in ("7994") or ICD_DGNS_CD11 in ("7994") or ICD_DGNS_CD12 in ("7994") or ICD_DGNS_CD13 in ("7994") or ICD_DGNS_CD14 in ("7994") or ICD_DGNS_CD15 in ("7994") or ICD_DGNS_CD16 in ("7994") or ICD_DGNS_CD17 in ("7994") or ICD_DGNS_CD18 in ("7994") or ICD_DGNS_CD19 in ("7994") or ICD_DGNS_CD20 in ("7994") or ICD_DGNS_CD21 in ("7994") or ICD_DGNS_CD22 in ("7994") or ICD_DGNS_CD23 in ("7994") or ICD_DGNS_CD24 in ("7994") or ICD_DGNS_CD25 in ("7994")  ) then 1 else 0 end as Frail4, 
case when  (PRNCPAL_DGNS_CD in ("7993") or ICD_DGNS_CD1 in ("7993") or ICD_DGNS_CD2 in ("7993") or ICD_DGNS_CD3 in ("7993") or ICD_DGNS_CD4 in ("7993") or ICD_DGNS_CD5 in ("7993") or ICD_DGNS_CD6 in ("7993")  or ICD_DGNS_CD7 in ("7993")  or ICD_DGNS_CD8 in ("7993")  or ICD_DGNS_CD9 in ("7993")  or ICD_DGNS_CD10 in ("7993")  or ICD_DGNS_CD11 in ("7993")  or ICD_DGNS_CD12 in ("7993")  or ICD_DGNS_CD13 in ("7993")  or ICD_DGNS_CD14 in ("7993")  or ICD_DGNS_CD15 in ("7993")  or ICD_DGNS_CD16 in ("7993")  or ICD_DGNS_CD17 in ("7993")  or ICD_DGNS_CD18 in ("7993")  or ICD_DGNS_CD19 in ("7993")  or ICD_DGNS_CD20 in ("7993")  or ICD_DGNS_CD21 in ("7993")  or ICD_DGNS_CD22 in ("7993")  or ICD_DGNS_CD23 in ("7993")  or ICD_DGNS_CD24 in ("7993")  or ICD_DGNS_CD25 in ("7993")  ) then 1 else 0 end as Frail5, 
case when  (PRNCPAL_DGNS_CD in ("7197") or ICD_DGNS_CD1 in ("7197") or ICD_DGNS_CD2 in ("7197") or ICD_DGNS_CD3 in ("7197") or ICD_DGNS_CD4 in ("7197") or ICD_DGNS_CD5 in ("7197") or ICD_DGNS_CD6 in ("7197") or ICD_DGNS_CD7 in ("7197") or ICD_DGNS_CD8 in ("7197") or ICD_DGNS_CD9 in ("7197") or ICD_DGNS_CD10 in ("7197") or ICD_DGNS_CD11 in ("7197") or ICD_DGNS_CD12 in ("7197") or ICD_DGNS_CD13 in ("7197") or ICD_DGNS_CD14 in ("7197") or ICD_DGNS_CD15 in ("7197") or ICD_DGNS_CD16 in ("7197") or ICD_DGNS_CD17 in ("7197") or ICD_DGNS_CD18 in ("7197") or ICD_DGNS_CD19 in ("7197") or ICD_DGNS_CD20 in ("7197") or ICD_DGNS_CD21 in ("7197") or ICD_DGNS_CD22 in ("7197") or ICD_DGNS_CD23 in ("7197") or ICD_DGNS_CD24 in ("7197") or ICD_DGNS_CD25 in ("7197") ) then 1 else 0 end as Frail6, 
case when  (PRNCPAL_DGNS_CD in ("V1588") or ICD_DGNS_CD1 in ("V1588") or ICD_DGNS_CD2 in ("V1588") or ICD_DGNS_CD3 in ("V1588") or ICD_DGNS_CD4 in ("V1588") or ICD_DGNS_CD5 in ("V1588") or ICD_DGNS_CD6 in ("V1588") or ICD_DGNS_CD7 in ("V1588") or ICD_DGNS_CD8 in ("V1588") or ICD_DGNS_CD9 in ("V1588") or ICD_DGNS_CD10 in ("V1588") or ICD_DGNS_CD11 in ("V1588") or ICD_DGNS_CD12 in ("V1588") or ICD_DGNS_CD13 in ("V1588") or ICD_DGNS_CD14 in ("V1588") or ICD_DGNS_CD15 in ("V1588") or ICD_DGNS_CD16 in ("V1588") or ICD_DGNS_CD17 in ("V1588") or ICD_DGNS_CD18 in ("V1588") or ICD_DGNS_CD19 in ("V1588") or ICD_DGNS_CD20 in ("V1588") or ICD_DGNS_CD21 in ("V1588") or ICD_DGNS_CD22 in ("V1588") or ICD_DGNS_CD23 in ("V1588") or ICD_DGNS_CD24 in ("V1588") or ICD_DGNS_CD25 in ("V1588")  ) then 1 else 0 end as Frail7, 
case when  (PRNCPAL_DGNS_CD in ("7282") or ICD_DGNS_CD1 in ("7282") or ICD_DGNS_CD2 in ("7282") or ICD_DGNS_CD3 in ("7282") or ICD_DGNS_CD4 in ("7282") or ICD_DGNS_CD5 in ("7282") or ICD_DGNS_CD6 in ("7282")  or ICD_DGNS_CD7 in ("7282") or ICD_DGNS_CD8 in ("7282") or ICD_DGNS_CD9 in ("7282") or ICD_DGNS_CD10 in ("7282") or ICD_DGNS_CD11 in ("7282") or ICD_DGNS_CD12 in ("7282") or ICD_DGNS_CD13 in ("7282") or ICD_DGNS_CD14 in ("7282") or ICD_DGNS_CD15 in ("7282") or ICD_DGNS_CD16 in ("7282") or ICD_DGNS_CD17 in ("7282") or ICD_DGNS_CD18 in ("7282") or ICD_DGNS_CD19 in ("7282") or ICD_DGNS_CD20 in ("7282") or ICD_DGNS_CD21 in ("7282") or ICD_DGNS_CD22 in ("7282") or ICD_DGNS_CD23 in ("7282") or ICD_DGNS_CD24 in ("7282") or ICD_DGNS_CD25 in ("7282") ) then 1 else 0 end as Frail8, 
case when  (PRNCPAL_DGNS_CD in ("72887") or ICD_DGNS_CD1 in ("72887") or ICD_DGNS_CD2 in ("72887") or ICD_DGNS_CD3 in ("72887") or ICD_DGNS_CD4 in ("72887") or ICD_DGNS_CD5 in ("72887") or ICD_DGNS_CD6 in ("72887") or ICD_DGNS_CD7 in ("72887") or ICD_DGNS_CD8 in ("72887") or ICD_DGNS_CD9 in ("72887") or ICD_DGNS_CD10 in ("72887") or ICD_DGNS_CD11 in ("72887") or ICD_DGNS_CD12 in ("72887") or ICD_DGNS_CD13 in ("72887") or ICD_DGNS_CD14 in ("72887") or ICD_DGNS_CD15 in ("72887") or ICD_DGNS_CD16 in ("72887") or ICD_DGNS_CD17 in ("72887") or ICD_DGNS_CD18 in ("72887") or ICD_DGNS_CD19 in ("72887") or ICD_DGNS_CD20 in ("72887") or ICD_DGNS_CD21 in ("72887") or ICD_DGNS_CD22 in ("72887") or ICD_DGNS_CD23 in ("72887") or ICD_DGNS_CD24 in ("72887") or ICD_DGNS_CD25 in ("72887")   ) then 1 else 0 end as Frail9, 
case when  (PRNCPAL_DGNS_CD in (select ICD from HCC.Icd2hccxw2013 where HCC=148) or ICD_DGNS_CD1 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD11 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD12 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD13 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD14 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD15 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD16 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD17 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD18 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD19 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD20 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD21 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD22 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD23 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD24 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD25 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  ) then 1 else 0 end as Frail10, 
case when  (PRNCPAL_DGNS_CD in ("797") or ICD_DGNS_CD1 in ("797") or ICD_DGNS_CD2 in ("797") or ICD_DGNS_CD3 in ("797") or ICD_DGNS_CD4 in ("797") or ICD_DGNS_CD5 in ("797") or ICD_DGNS_CD6 in ("797") or ICD_DGNS_CD7 in ("797")  or ICD_DGNS_CD8 in ("797")  or ICD_DGNS_CD9 in ("797")  or ICD_DGNS_CD10 in ("797")  or ICD_DGNS_CD11 in ("797")  or ICD_DGNS_CD12 in ("797")  or ICD_DGNS_CD13 in ("797")  or ICD_DGNS_CD14 in ("797")  or ICD_DGNS_CD15 in ("797")  or ICD_DGNS_CD16 in ("797")  or ICD_DGNS_CD17 in ("797")  or ICD_DGNS_CD18 in ("797")  or ICD_DGNS_CD19 in ("797")  or ICD_DGNS_CD20 in ("797")  or ICD_DGNS_CD21 in ("797")  or ICD_DGNS_CD22 in ("797")  or ICD_DGNS_CD23 in ("797")  or ICD_DGNS_CD24 in ("797")  or ICD_DGNS_CD25 in ("797")  ) then 1 else 0 end as Frail11
from Hospice.Hspcclms2009;
quit;
 

proc sql;
create table Hospice2009_1 as
select bene_id, 
case when  HCPCS_CD in ('E0100', 'E0105', 'E0130', 'E0135', 'E0140', 'E0141', 'E0143', 'E0144', 'E0147', 'E0148', 'E0149', 'E0160', 'E0161','E0162','E0163','E0164','E0165','E0166','E0167','E0168','E0169','E0170','E0171') 
then 1 else 0 end as frail12 
from Hospice.Hspcrev2009;
quit;

*SNF;

 proc sql;
create table SNF2009_0 as
select bene_id, 
case when  (PRNCPAL_DGNS_CD  in ("7812") or ICD_DGNS_CD1  in ("7812") or ICD_DGNS_CD2  in ("7812") or ICD_DGNS_CD3  in ("7812") or ICD_DGNS_CD4  in ("7812") or ICD_DGNS_CD5  in ("7812") or ICD_DGNS_CD6  in ("7812") or ICD_DGNS_CD7  in ("7812") or ICD_DGNS_CD8  in ("7812") or ICD_DGNS_CD9  in ("7812") or ICD_DGNS_CD10  in ("7812") or ICD_DGNS_CD11  in ("7812") or ICD_DGNS_CD12  in ("7812")  or ICD_DGNS_CD13  in ("7812") or ICD_DGNS_CD14  in ("7812") or ICD_DGNS_CD15  in ("7812") or ICD_DGNS_CD16  in ("7812") or ICD_DGNS_CD17  in ("7812") or ICD_DGNS_CD18  in ("7812") or ICD_DGNS_CD19  in ("7812") or ICD_DGNS_CD20  in ("7812") or ICD_DGNS_CD21  in ("7812") or ICD_DGNS_CD22  in ("7812") or ICD_DGNS_CD23  in ("7812") or ICD_DGNS_CD24  in ("7812") or ICD_DGNS_CD25  in ("7812")) then 1 else 0 end as Frail1, 
case when  (PRNCPAL_DGNS_CD in (select ICD from HCC.Icd2hccxw2013 where HCC=21) or ICD_DGNS_CD1 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD11 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD12 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD13 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD14 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD15 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD16 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD17 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD18 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD19 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD20 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD21 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD22 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD23 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD24 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD25 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) ) then 1 else 0 end as Frail2, 
case when  (PRNCPAL_DGNS_CD in ("7837") or ICD_DGNS_CD1 in ("7837") or ICD_DGNS_CD2 in ("7837") or ICD_DGNS_CD3 in ("7837") or ICD_DGNS_CD4 in ("7837") or ICD_DGNS_CD5 in ("7837") or ICD_DGNS_CD6 in ("7837") or ICD_DGNS_CD7 in ("7837") or ICD_DGNS_CD8 in ("7837") or ICD_DGNS_CD9 in ("7837") or ICD_DGNS_CD10 in ("7837") or ICD_DGNS_CD11 in ("7837") or ICD_DGNS_CD12 in ("7837") or ICD_DGNS_CD13 in ("7837") or ICD_DGNS_CD14 in ("7837") or ICD_DGNS_CD15 in ("7837") or ICD_DGNS_CD16 in ("7837") or ICD_DGNS_CD17 in ("7837") or ICD_DGNS_CD18 in ("7837") or ICD_DGNS_CD19 in ("7837") or ICD_DGNS_CD20 in ("7837") or ICD_DGNS_CD21 in ("7837") or ICD_DGNS_CD22 in ("7837") or ICD_DGNS_CD23 in ("7837") or ICD_DGNS_CD24 in ("7837") or ICD_DGNS_CD25 in ("7837") ) then 1 else 0 end as Frail3, 
case when  (PRNCPAL_DGNS_CD in ("7994") or ICD_DGNS_CD1 in ("7994") or ICD_DGNS_CD2 in ("7994") or ICD_DGNS_CD3 in ("7994") or ICD_DGNS_CD4 in ("7994") or ICD_DGNS_CD5 in ("7994") or ICD_DGNS_CD6 in ("7994") or ICD_DGNS_CD7 in ("7994") or ICD_DGNS_CD8 in ("7994") or ICD_DGNS_CD9 in ("7994") or ICD_DGNS_CD10 in ("7994") or ICD_DGNS_CD11 in ("7994") or ICD_DGNS_CD12 in ("7994") or ICD_DGNS_CD13 in ("7994") or ICD_DGNS_CD14 in ("7994") or ICD_DGNS_CD15 in ("7994") or ICD_DGNS_CD16 in ("7994") or ICD_DGNS_CD17 in ("7994") or ICD_DGNS_CD18 in ("7994") or ICD_DGNS_CD19 in ("7994") or ICD_DGNS_CD20 in ("7994") or ICD_DGNS_CD21 in ("7994") or ICD_DGNS_CD22 in ("7994") or ICD_DGNS_CD23 in ("7994") or ICD_DGNS_CD24 in ("7994") or ICD_DGNS_CD25 in ("7994")  ) then 1 else 0 end as Frail4, 
case when  (PRNCPAL_DGNS_CD in ("7993") or ICD_DGNS_CD1 in ("7993") or ICD_DGNS_CD2 in ("7993") or ICD_DGNS_CD3 in ("7993") or ICD_DGNS_CD4 in ("7993") or ICD_DGNS_CD5 in ("7993") or ICD_DGNS_CD6 in ("7993")  or ICD_DGNS_CD7 in ("7993")  or ICD_DGNS_CD8 in ("7993")  or ICD_DGNS_CD9 in ("7993")  or ICD_DGNS_CD10 in ("7993")  or ICD_DGNS_CD11 in ("7993")  or ICD_DGNS_CD12 in ("7993")  or ICD_DGNS_CD13 in ("7993")  or ICD_DGNS_CD14 in ("7993")  or ICD_DGNS_CD15 in ("7993")  or ICD_DGNS_CD16 in ("7993")  or ICD_DGNS_CD17 in ("7993")  or ICD_DGNS_CD18 in ("7993")  or ICD_DGNS_CD19 in ("7993")  or ICD_DGNS_CD20 in ("7993")  or ICD_DGNS_CD21 in ("7993")  or ICD_DGNS_CD22 in ("7993")  or ICD_DGNS_CD23 in ("7993")  or ICD_DGNS_CD24 in ("7993")  or ICD_DGNS_CD25 in ("7993")  ) then 1 else 0 end as Frail5, 
case when  (PRNCPAL_DGNS_CD in ("7197") or ICD_DGNS_CD1 in ("7197") or ICD_DGNS_CD2 in ("7197") or ICD_DGNS_CD3 in ("7197") or ICD_DGNS_CD4 in ("7197") or ICD_DGNS_CD5 in ("7197") or ICD_DGNS_CD6 in ("7197") or ICD_DGNS_CD7 in ("7197") or ICD_DGNS_CD8 in ("7197") or ICD_DGNS_CD9 in ("7197") or ICD_DGNS_CD10 in ("7197") or ICD_DGNS_CD11 in ("7197") or ICD_DGNS_CD12 in ("7197") or ICD_DGNS_CD13 in ("7197") or ICD_DGNS_CD14 in ("7197") or ICD_DGNS_CD15 in ("7197") or ICD_DGNS_CD16 in ("7197") or ICD_DGNS_CD17 in ("7197") or ICD_DGNS_CD18 in ("7197") or ICD_DGNS_CD19 in ("7197") or ICD_DGNS_CD20 in ("7197") or ICD_DGNS_CD21 in ("7197") or ICD_DGNS_CD22 in ("7197") or ICD_DGNS_CD23 in ("7197") or ICD_DGNS_CD24 in ("7197") or ICD_DGNS_CD25 in ("7197") ) then 1 else 0 end as Frail6, 
case when  (PRNCPAL_DGNS_CD in ("V1588") or ICD_DGNS_CD1 in ("V1588") or ICD_DGNS_CD2 in ("V1588") or ICD_DGNS_CD3 in ("V1588") or ICD_DGNS_CD4 in ("V1588") or ICD_DGNS_CD5 in ("V1588") or ICD_DGNS_CD6 in ("V1588") or ICD_DGNS_CD7 in ("V1588") or ICD_DGNS_CD8 in ("V1588") or ICD_DGNS_CD9 in ("V1588") or ICD_DGNS_CD10 in ("V1588") or ICD_DGNS_CD11 in ("V1588") or ICD_DGNS_CD12 in ("V1588") or ICD_DGNS_CD13 in ("V1588") or ICD_DGNS_CD14 in ("V1588") or ICD_DGNS_CD15 in ("V1588") or ICD_DGNS_CD16 in ("V1588") or ICD_DGNS_CD17 in ("V1588") or ICD_DGNS_CD18 in ("V1588") or ICD_DGNS_CD19 in ("V1588") or ICD_DGNS_CD20 in ("V1588") or ICD_DGNS_CD21 in ("V1588") or ICD_DGNS_CD22 in ("V1588") or ICD_DGNS_CD23 in ("V1588") or ICD_DGNS_CD24 in ("V1588") or ICD_DGNS_CD25 in ("V1588")  ) then 1 else 0 end as Frail7, 
case when  (PRNCPAL_DGNS_CD in ("7282") or ICD_DGNS_CD1 in ("7282") or ICD_DGNS_CD2 in ("7282") or ICD_DGNS_CD3 in ("7282") or ICD_DGNS_CD4 in ("7282") or ICD_DGNS_CD5 in ("7282") or ICD_DGNS_CD6 in ("7282")  or ICD_DGNS_CD7 in ("7282") or ICD_DGNS_CD8 in ("7282") or ICD_DGNS_CD9 in ("7282") or ICD_DGNS_CD10 in ("7282") or ICD_DGNS_CD11 in ("7282") or ICD_DGNS_CD12 in ("7282") or ICD_DGNS_CD13 in ("7282") or ICD_DGNS_CD14 in ("7282") or ICD_DGNS_CD15 in ("7282") or ICD_DGNS_CD16 in ("7282") or ICD_DGNS_CD17 in ("7282") or ICD_DGNS_CD18 in ("7282") or ICD_DGNS_CD19 in ("7282") or ICD_DGNS_CD20 in ("7282") or ICD_DGNS_CD21 in ("7282") or ICD_DGNS_CD22 in ("7282") or ICD_DGNS_CD23 in ("7282") or ICD_DGNS_CD24 in ("7282") or ICD_DGNS_CD25 in ("7282") ) then 1 else 0 end as Frail8, 
case when  (PRNCPAL_DGNS_CD in ("72887") or ICD_DGNS_CD1 in ("72887") or ICD_DGNS_CD2 in ("72887") or ICD_DGNS_CD3 in ("72887") or ICD_DGNS_CD4 in ("72887") or ICD_DGNS_CD5 in ("72887") or ICD_DGNS_CD6 in ("72887") or ICD_DGNS_CD7 in ("72887") or ICD_DGNS_CD8 in ("72887") or ICD_DGNS_CD9 in ("72887") or ICD_DGNS_CD10 in ("72887") or ICD_DGNS_CD11 in ("72887") or ICD_DGNS_CD12 in ("72887") or ICD_DGNS_CD13 in ("72887") or ICD_DGNS_CD14 in ("72887") or ICD_DGNS_CD15 in ("72887") or ICD_DGNS_CD16 in ("72887") or ICD_DGNS_CD17 in ("72887") or ICD_DGNS_CD18 in ("72887") or ICD_DGNS_CD19 in ("72887") or ICD_DGNS_CD20 in ("72887") or ICD_DGNS_CD21 in ("72887") or ICD_DGNS_CD22 in ("72887") or ICD_DGNS_CD23 in ("72887") or ICD_DGNS_CD24 in ("72887") or ICD_DGNS_CD25 in ("72887")   ) then 1 else 0 end as Frail9, 
case when  (PRNCPAL_DGNS_CD in (select ICD from HCC.Icd2hccxw2013 where HCC=148) or ICD_DGNS_CD1 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD11 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD12 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD13 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD14 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD15 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD16 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD17 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD18 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD19 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD20 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD21 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD22 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD23 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD24 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD25 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  ) then 1 else 0 end as Frail10, 
case when  (PRNCPAL_DGNS_CD in ("797") or ICD_DGNS_CD1 in ("797") or ICD_DGNS_CD2 in ("797") or ICD_DGNS_CD3 in ("797") or ICD_DGNS_CD4 in ("797") or ICD_DGNS_CD5 in ("797") or ICD_DGNS_CD6 in ("797") or ICD_DGNS_CD7 in ("797")  or ICD_DGNS_CD8 in ("797")  or ICD_DGNS_CD9 in ("797")  or ICD_DGNS_CD10 in ("797")  or ICD_DGNS_CD11 in ("797")  or ICD_DGNS_CD12 in ("797")  or ICD_DGNS_CD13 in ("797")  or ICD_DGNS_CD14 in ("797")  or ICD_DGNS_CD15 in ("797")  or ICD_DGNS_CD16 in ("797")  or ICD_DGNS_CD17 in ("797")  or ICD_DGNS_CD18 in ("797")  or ICD_DGNS_CD19 in ("797")  or ICD_DGNS_CD20 in ("797")  or ICD_DGNS_CD21 in ("797")  or ICD_DGNS_CD22 in ("797")  or ICD_DGNS_CD23 in ("797")  or ICD_DGNS_CD24 in ("797")  or ICD_DGNS_CD25 in ("797")  ) then 1 else 0 end as Frail11 
from SNF.SNFclms2009;
quit;

proc sql;
create table SNF2009_1 as
select bene_id, 
case when  HCPCS_CD in ('E0100', 'E0105', 'E0130', 'E0135', 'E0140', 'E0141', 'E0143', 'E0144', 'E0147', 'E0148', 'E0149', 'E0160', 'E0161','E0162','E0163','E0164','E0165','E0166','E0167','E0168','E0169','E0170','E0171') 
then 1 else 0 end as frail12 
from SNF.SNFrev2009;
quit;




*DME;

 proc sql;
create table DME2009_0 as
select bene_id, 
case when  (PRNCPAL_DGNS_CD  in ("7812") or ICD_DGNS_CD1  in ("7812") or ICD_DGNS_CD2  in ("7812") or ICD_DGNS_CD3  in ("7812") or ICD_DGNS_CD4  in ("7812") or ICD_DGNS_CD5  in ("7812") or ICD_DGNS_CD6  in ("7812") or ICD_DGNS_CD7  in ("7812") or ICD_DGNS_CD8  in ("7812") or ICD_DGNS_CD9  in ("7812") or ICD_DGNS_CD10  in ("7812") or ICD_DGNS_CD11  in ("7812") or ICD_DGNS_CD12  in ("7812")  ) then 1 else 0 end as Frail1, 
case when  (PRNCPAL_DGNS_CD in (select ICD from HCC.Icd2hccxw2013 where HCC=21) or ICD_DGNS_CD1 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD11 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) or ICD_DGNS_CD12 in (select ICD from HCC.Icd2hccxw2014 where HCC=21) ) then 1 else 0 end as Frail2, 
case when  (PRNCPAL_DGNS_CD in ("7837") or ICD_DGNS_CD1 in ("7837") or ICD_DGNS_CD2 in ("7837") or ICD_DGNS_CD3 in ("7837") or ICD_DGNS_CD4 in ("7837") or ICD_DGNS_CD5 in ("7837") or ICD_DGNS_CD6 in ("7837") or ICD_DGNS_CD7 in ("7837") or ICD_DGNS_CD8 in ("7837") or ICD_DGNS_CD9 in ("7837") or ICD_DGNS_CD10 in ("7837") or ICD_DGNS_CD11 in ("7837") or ICD_DGNS_CD12 in ("7837") ) then 1 else 0 end as Frail3, 
case when  (PRNCPAL_DGNS_CD in ("7994") or ICD_DGNS_CD1 in ("7994") or ICD_DGNS_CD2 in ("7994") or ICD_DGNS_CD3 in ("7994") or ICD_DGNS_CD4 in ("7994") or ICD_DGNS_CD5 in ("7994") or ICD_DGNS_CD6 in ("7994") or ICD_DGNS_CD7 in ("7994") or ICD_DGNS_CD8 in ("7994") or ICD_DGNS_CD9 in ("7994") or ICD_DGNS_CD10 in ("7994") or ICD_DGNS_CD11 in ("7994") or ICD_DGNS_CD12 in ("7994") ) then 1 else 0 end as Frail4, 
case when  (PRNCPAL_DGNS_CD in ("7993") or ICD_DGNS_CD1 in ("7993") or ICD_DGNS_CD2 in ("7993") or ICD_DGNS_CD3 in ("7993") or ICD_DGNS_CD4 in ("7993") or ICD_DGNS_CD5 in ("7993") or ICD_DGNS_CD6 in ("7993")  or ICD_DGNS_CD7 in ("7993")  or ICD_DGNS_CD8 in ("7993")  or ICD_DGNS_CD9 in ("7993")  or ICD_DGNS_CD10 in ("7993")  or ICD_DGNS_CD11 in ("7993")  or ICD_DGNS_CD12 in ("7993")  ) then 1 else 0 end as Frail5, 
case when  (PRNCPAL_DGNS_CD in ("7197") or ICD_DGNS_CD1 in ("7197") or ICD_DGNS_CD2 in ("7197") or ICD_DGNS_CD3 in ("7197") or ICD_DGNS_CD4 in ("7197") or ICD_DGNS_CD5 in ("7197") or ICD_DGNS_CD6 in ("7197") or ICD_DGNS_CD7 in ("7197") or ICD_DGNS_CD8 in ("7197") or ICD_DGNS_CD9 in ("7197") or ICD_DGNS_CD10 in ("7197") or ICD_DGNS_CD11 in ("7197") or ICD_DGNS_CD12 in ("7197") ) then 1 else 0 end as Frail6, 
case when  (PRNCPAL_DGNS_CD in ("V1588") or ICD_DGNS_CD1 in ("V1588") or ICD_DGNS_CD2 in ("V1588") or ICD_DGNS_CD3 in ("V1588") or ICD_DGNS_CD4 in ("V1588") or ICD_DGNS_CD5 in ("V1588") or ICD_DGNS_CD6 in ("V1588") or ICD_DGNS_CD7 in ("V1588") or ICD_DGNS_CD8 in ("V1588") or ICD_DGNS_CD9 in ("V1588") or ICD_DGNS_CD10 in ("V1588") or ICD_DGNS_CD11 in ("V1588") or ICD_DGNS_CD12 in ("V1588")  ) then 1 else 0 end as Frail7, 
case when  (PRNCPAL_DGNS_CD in ("7282") or ICD_DGNS_CD1 in ("7282") or ICD_DGNS_CD2 in ("7282") or ICD_DGNS_CD3 in ("7282") or ICD_DGNS_CD4 in ("7282") or ICD_DGNS_CD5 in ("7282") or ICD_DGNS_CD6 in ("7282")  or ICD_DGNS_CD7 in ("7282") or ICD_DGNS_CD8 in ("7282") or ICD_DGNS_CD9 in ("7282") or ICD_DGNS_CD10 in ("7282") or ICD_DGNS_CD11 in ("7282") or ICD_DGNS_CD12 in ("7282")  ) then 1 else 0 end as Frail8, 
case when  (PRNCPAL_DGNS_CD in ("72887") or ICD_DGNS_CD1 in ("72887") or ICD_DGNS_CD2 in ("72887") or ICD_DGNS_CD3 in ("72887") or ICD_DGNS_CD4 in ("72887") or ICD_DGNS_CD5 in ("72887") or ICD_DGNS_CD6 in ("72887") or ICD_DGNS_CD7 in ("72887") or ICD_DGNS_CD8 in ("72887") or ICD_DGNS_CD9 in ("72887") or ICD_DGNS_CD10 in ("72887") or ICD_DGNS_CD11 in ("72887") or ICD_DGNS_CD12 in ("72887")  ) then 1 else 0 end as Frail9, 
case when  (PRNCPAL_DGNS_CD in (select ICD from HCC.Icd2hccxw2013 where HCC=148) or ICD_DGNS_CD1 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD2 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD3 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD4 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD5 in (select ICD from HCC.Icd2hccxw2014 where HCC=148) or ICD_DGNS_CD6 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD7 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD8 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD9 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD10 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD11 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)  or ICD_DGNS_CD12 in (select ICD from HCC.Icd2hccxw2014 where HCC=148)) then 1 else 0 end as Frail10, 
case when  (PRNCPAL_DGNS_CD in ("797") or ICD_DGNS_CD1 in ("797") or ICD_DGNS_CD2 in ("797") or ICD_DGNS_CD3 in ("797") or ICD_DGNS_CD4 in ("797") or ICD_DGNS_CD5 in ("797") or ICD_DGNS_CD6 in ("797") or ICD_DGNS_CD7 in ("797")  or ICD_DGNS_CD8 in ("797")  or ICD_DGNS_CD9 in ("797")  or ICD_DGNS_CD10 in ("797")  or ICD_DGNS_CD11 in ("797")  or ICD_DGNS_CD12 in ("797")) then 1 else 0 end as Frail11 
from DME.DMEclms2009;
quit;

proc sql;
create table DME2009_1 as
select bene_id, 
case when  HCPCS_CD in ('E0100', 'E0105', 'E0130', 'E0135', 'E0140', 'E0141', 'E0143', 'E0144', 'E0147', 'E0148', 'E0149', 'E0160', 'E0161','E0162','E0163','E0164','E0165','E0166','E0167','E0168','E0169','E0170','E0171') 
then 1 else 0 end as frail12 
from DME.DMEline2009;
quit;


 
 

libname data 'C:\data\Projects\Peterson\Data-XZ';
data temp; 
set IP2009_0 IP2009_1 OP2009_0 OP2009_1 Carrier2009_0 Carrier2009_1 
HHA2009_0 HHA2009_1 Hospice2009_0 Hospice2009_1 SNF2009_0 SNF2009_1 DME2009_0 DME2009_1;
proc sort;by bene_id;
run;

proc sql;
create table temp1 as
select bene_id, sum(frail1) as f1, sum(frail2) as f2, sum(frail3) as f3, sum(frail4) as f4, sum(frail5) as f5, sum(frail6) as f6,
sum(frail7) as f7, sum(frail8) as f8, sum(frail9) as f9, sum(frail10) as f10, sum(frail11) as f11, sum(frail12) as f12
from temp
group by bene_id;
quit;

data data.CC2009;
set temp1;
Frailty1=0;Frailty2=0;Frailty3=0;Frailty4=0;Frailty5=0;Frailty6=0;Frailty7=0;Frailty8=0;Frailty9=0;Frailty10=0;Frailty11=0;Frailty12=0;
if f1>0 then Frailty1=1; label Frailty1="Abnormality of gait";
if f2>0 then Frailty2=1; label Frailty2="Abnormal loss of weight and underweight";
if f3>0 then Frailty3=1; label Frailty3="Adult failure to thrive";
if f4>0 then Frailty4=1; label Frailty4="Cachexia";
if f5>0 then Frailty5=1; label Frailty5="Debility ";
if f6>0 then Frailty6=1; label Frailty6="Difficulty in walking ";
if f7>0 then Frailty7=1; label Frailty7="Fall ";
if f8>0 then Frailty8=1; label Frailty8="Muscular wasting and disuse atrophy";
if f9>0 then Frailty9=1; label Frailty9="Muscle weakness";
if f10>0 then Frailty10=1; label Frailty10="Pressure Ulcer";
if f11>0 then Frailty11=1; label Frailty11="Senility without mention of psychosis";
if f12>0 then Frailty12=1; label Frailty12="Durable medical equipment";

keep bene_id Frailty1 Frailty2 Frailty3 Frailty4 Frailty5 Frailty6 Frailty7 Frailty8 Frailty9 Frailty10 Frailty11 Frailty12;
proc sort nodupkey;by bene_id;
proc freq;tables Frailty1 Frailty2 Frailty3 Frailty4 Frailty5 Frailty6 Frailty7 Frailty8 Frailty9 Frailty10 Frailty11 Frailty12;
run;
