*****************************************
Logistic regression
Xiner Zhou
3/2/2017
*****************************************;
libname MMleads 'D:\Data\MMLEADS\Data';
libname denom 'D:\Data\Medicare\Denominator';
libname data 'D:\Projects\Peterson\Data';


**********************************
Plan A
**********************************;
* Bene demog info from data.bene2008 , restrict to data.PlanABene only;
proc sql;
create table temp1 as
select a.*,b.*
from data.bene2008 a inner join data.PlanABene b
on a.bene_id=b.bene_id;
quit;
 

data temp2;
set temp1 ;
 
N_CCW=HYPTHY2008+AMI2008+ALZ2008+ANEMIA2008+ASTHMA2008+AFIB2008+HYPPLA2008+CAT2008+CKD2008+COPD2008+ 
CHF2008+DEPR2008+DIAB2008+GLCM2008+HFRAC2008+HYPLIP2008+HYPTEN2008+IHD2008+OST2008+RAOA2008+
STRK2008+BRC2008+CRC2008+LNGC2008+PRC2008+ ENDC2008+ ACP2008+ ANXI2008+ BIPL2008+DEPSN2008+
PSDS2008+PTRA2008+ SCHI2008+SCHIOT2008+TOBA2008+AUTISM2008+BRAINJ2008+CERPAL2008+CYSFIB2008+ EPILEP2008+
HEARIM2008+INTDIS2008+LEADIS2008+MOBIMP2008+ MULSCL2008+MUSDYS2008+SPIBIF2008+SPIINJ2008+VISUAL2008+ALCO2008+
DRUG2008+FIBRO2008+HEPVIRAL2008+HEPB_ACT2008+HEPB_CHR2008+ HEPC_ACT2008+HEPC_CHR2008+HEPC_UNS2008+HEPD2008+HEPE2008+
HIVAIDS_1YR2008+HIVAIDS2008+HIVARV2008+LEUKLYMPH2008+LIVER2008+ MIGRAINE2008+OBESITY2008+ OTHDEL2008+PVD2008+ULCERS2008;
 
array temp{71}
 
N_CCW 
HYPTHY2008 AMI2008 ALZ2008 ANEMIA2008 ASTHMA2008 AFIB2008 HYPPLA2008 CAT2008 CKD2008 COPD2008  
CHF2008 DEPR2008 DIAB2008 GLCM2008 HFRAC2008 HYPLIP2008 HYPTEN2008 IHD2008 OST2008 RAOA2008 
STRK2008 BRC2008 CRC2008 LNGC2008 PRC2008  ENDC2008  ACP2008  ANXI2008  BIPL2008 DEPSN2008 
PSDS2008 PTRA2008  SCHI2008 SCHIOT2008 TOBA2008 AUTISM2008 BRAINJ2008 CERPAL2008 CYSFIB2008  EPILEP2008 
HEARIM2008 INTDIS2008 LEADIS2008 MOBIMP2008  MULSCL2008 MUSDYS2008 SPIBIF2008 SPIINJ2008 VISUAL2008 ALCO2008 
DRUG2008 FIBRO2008 HEPVIRAL2008 HEPB_ACT2008 HEPB_CHR2008  HEPC_ACT2008 HEPC_CHR2008 HEPC_UNS2008 HEPD2008 HEPE2008 
HIVAIDS_1YR2008 HIVAIDS2008 HIVARV2008 LEUKLYMPH2008 LIVER2008  MIGRAINE2008 OBESITY2008  OTHDEL2008 PVD2008 ULCERS2008 ;
  do i=1 to 71;
if temp{i}=. then temp{i}=0;
end;
drop i;

if group="HC HC HC" then groupnum=2;
else if group="nonHC nonHC nonHC" then groupnum=0;
else groupnum=1;
proc freq;tables group groupnum 
D_sex RaceGroup AgeGroup region  E_MS_CD E_BOE  MHI2008 Edu2008  
HYPTHY2008/missing;
 
run;
 

ods excel file="D:\Projects\Peterson\Logistic.xlsx" style=minimal;
proc logistic data=temp2 desc;
 * where groupnum in (0,1);
class groupnum(ref='0') 
D_STATE_CD D_sex(ref='M')  RaceGroup(ref="White")   MHI2008(ref='1') Edu2008(ref='1') Region(ref="HRSA Region 2:New York and New Jersey")
HYPTHY2008(ref='0')  AMI2008(ref='0')  ALZ2008(ref='0')  ANEMIA2008(ref='0')  ASTHMA2008(ref='0')  AFIB2008(ref='0')  HYPPLA2008(ref='0')  CAT2008(ref='0')  CKD2008(ref='0')  COPD2008(ref='0')   
CHF2008(ref='0')  DEPR2008(ref='0')  DIAB2008(ref='0')  GLCM2008(ref='0')  HFRAC2008(ref='0')  HYPLIP2008(ref='0')  HYPTEN2008(ref='0')  IHD2008(ref='0')  OST2008(ref='0')  RAOA2008(ref='0')  
STRK2008(ref='0')  BRC2008(ref='0')  CRC2008(ref='0')  LNGC2008(ref='0')  PRC2008(ref='0')   ENDC2008(ref='0')   ACP2008(ref='0')   ANXI2008(ref='0')   BIPL2008(ref='0')  DEPSN2008(ref='0')  
PSDS2008(ref='0')  PTRA2008(ref='0')   SCHI2008(ref='0')  SCHIOT2008(ref='0')  TOBA2008(ref='0')  AUTISM2008(ref='0')  BRAINJ2008(ref='0')  CERPAL2008(ref='0')  CYSFIB2008(ref='0')   EPILEP2008(ref='0')  
HEARIM2008(ref='0')  INTDIS2008(ref='0')  LEADIS2008(ref='0')  MOBIMP2008(ref='0')   MULSCL2008(ref='0')  MUSDYS2008(ref='0')  SPIBIF2008(ref='0')  SPIINJ2008(ref='0')  VISUAL2008(ref='0')  ALCO2008(ref='0')  
DRUG2008(ref='0')  FIBRO2008(ref='0')  HEPVIRAL2008(ref='0')  HEPB_ACT2008(ref='0')  HEPB_CHR2008(ref='0')   HEPC_ACT2008(ref='0')  HEPC_CHR2008(ref='0')  HEPC_UNS2008(ref='0')  HEPD2008(ref='0')  HEPE2008(ref='0')  
HIVAIDS_1YR2008(ref='0')  HIVAIDS2008(ref='0')  HIVARV2008(ref='0')  LEUKLYMPH2008(ref='0')  LIVER2008(ref='0')   MIGRAINE2008(ref='0')  OBESITY2008(ref='0')   OTHDEL2008(ref='0')  PVD2008(ref='0')  ULCERS2008(ref='0')  
/param = ref;
model groupnum = D_sex RaceGroup D_AGE  MHI2008 Edu2008 region 
HYPTHY2008 AMI2008 ALZ2008 ANEMIA2008 ASTHMA2008 AFIB2008 HYPPLA2008 CAT2008 CKD2008 COPD2008  
CHF2008 DEPR2008 DIAB2008 GLCM2008 HFRAC2008 HYPLIP2008 HYPTEN2008 IHD2008 OST2008 RAOA2008 
STRK2008 BRC2008 CRC2008 LNGC2008 PRC2008  ENDC2008  ACP2008  ANXI2008  BIPL2008 DEPSN2008 
PSDS2008 PTRA2008  SCHI2008 SCHIOT2008 TOBA2008 AUTISM2008 BRAINJ2008 CERPAL2008 CYSFIB2008  EPILEP2008 
HEARIM2008 INTDIS2008 LEADIS2008 MOBIMP2008  MULSCL2008 MUSDYS2008 SPIBIF2008 SPIINJ2008 VISUAL2008 ALCO2008 
DRUG2008 FIBRO2008 HEPVIRAL2008 HEPB_ACT2008 HEPB_CHR2008  HEPC_ACT2008 HEPC_CHR2008 HEPC_UNS2008 HEPD2008 HEPE2008 
HIVAIDS_1YR2008 HIVAIDS2008 HIVARV2008 LEUKLYMPH2008 LIVER2008  MIGRAINE2008 OBESITY2008  OTHDEL2008 PVD2008 ULCERS2008 
/ scale=none clparm=wald clodds=pl rsquare;
*estimate "O.R. Cancer1-10 vs No" CancerI 1 -1 / exp;
unit D_AGE=10;
run;
ods excel close;
 
